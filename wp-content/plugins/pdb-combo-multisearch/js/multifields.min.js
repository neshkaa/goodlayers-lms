MultiFields=function(a){var f,b,e,g=!1,k={dialogClass:"participants-database-confirm",autoOpen:!1,height:"auto",minHeight:"20"},m=function(d){var c=e.closest(".add-field").find(".ajax-loading").css({visibility:"visible"});a.post(ajaxurl,{fieldname:e.val(),action:PDbCMS.action,task:"add_field",_pdbnonce:PDbCMS._pdbnonce},l).done(function(){c.css({visibility:"hidden"});var d=e.val();e.find("option[value="+d+"]").attr("disabled",!0);e.val("");var b=a("#combo_field_select");b.find('[value="'+d+'"]').prop("disabled",
!0);b.multiSelect("refresh")})},l=function(d){a(".multi-field-config-area").append(a(d.html))},n=function(d){d.preventDefault();var c=a(this).closest(".field-editor");f.html(PDbCMS.delete_confirm.replace("%s",c.find(".field-title").html()));f.dialog(k,{buttons:{Ok:function(){c.css("opacity","0.3");a(this).dialog("close");a.ajax({type:"post",url:ajaxurl,data:{fieldname:c.data("fieldname"),action:PDbCMS.action,task:"delete_field",_pdbnonce:PDbCMS._pdbnonce},beforeSend:function(){},success:function(a){"success"===
a.status?c.slideUp(600,function(){c.remove();e.find("option[value="+a.fieldname+"]").attr("disabled",!1)}):c.css("opacity","inherit")}})},Cancel:function(){a(this).dialog("close")}}});f.dialog("open");return!1},r={helper:p,handle:".dragger",update:function(d,c){a.post(ajaxurl,{action:PDbCMS.action,task:"reorder_fields",_pdbnonce:PDbCMS._pdbnonce,list:q(a(this))})}},p=function(d,c){c.children().each(function(){a(this).width(a(this).width())});return c},h=function(){g=!0},t=function(){g=!1},q=function(d){var c=
0,b="";d.find(".field-editor").each(function(){var d=a(this);""!==b&&(b+="&");b=b+c+"="+d.data("fieldname");c++});return b},u=function(a){g?(a.preventDefault(),a.returnValue=""):delete a.returnValue};return{init:function(){f=a("#confirmation-dialog");b=a("#multi-search-fields-selector-ui");e=b.find("select[name=new_field_name]");a("#add_multi_field").click(m);a(".multi-field-config-area").sortable(r);b.on("click",".editor-tools .delete-field",n);b.find("button[type=submit]").click(t);b.find(".field-editor input, .field-editor textarea").on("input",
h);b.find(".field-editor select, .field-editor input[type=checkbox]").on("change",h);a(window).on("beforeunload",u)}}}(jQuery);jQuery(function(){MultiFields.init()});